{% extends "PatentMS/base_model.html" %} 
{% load static %} 
{% block title_block%} 
{{ category.name}} 
- åˆ†ç±»è¯¦æƒ… 
{% endblock %} 
{% block body_block%}
{% if category %}
<!-- æ·»åŠ CSRF Token -->
{% csrf_token %}

<div data-category-id="{{ category.id }}">
  <!-- åˆ†ç±»å¤´éƒ¨ä¿¡æ¯ -->
  <div class="category-header mb-5" data-aos="fade-down">
    <div class="jumbotron p-5 text-center">
      <div class="container">
        <h1 class="display-4 fw-bold mb-3">
          <i class="fas fa-folder-open text-primary me-3"></i>
          {{ category.name }}
        </h1>
        <div
          class="category-stats d-flex justify-content-center align-items-center mb-4"
        >
          <div class="stat-item me-4">
            <i class="fas fa-eye text-info me-2"></i>
            <span class="fw-bold">{{ category.views }}</span> æ¬¡æµè§ˆ
          </div>
          <div class="stat-item me-4">
            <i class="fas fa-thumbs-up text-success me-2"></i>
            <span class="fw-bold" id="like_count">{{ category.likes }}</span>
            ä¸ªç‚¹èµ
          </div>
          <div class="stat-item">
            <i class="fas fa-file-alt text-warning me-2"></i>
            <span class="fw-bold">{{ pages.count }}</span> ä¸ªé¡µé¢
          </div>
        </div>
                <!-- è°ƒè¯•ä¿¡æ¯ -->
        <div class="alert alert-info mb-3">
          <h5>ğŸ”§ è°ƒè¯•ä¿¡æ¯</h5>
          <p>
            <strong>ç”¨æˆ·ç™»å½•çŠ¶æ€:</strong> 
            {{ user.is_authenticated|yesno:"å·²ç™»å½• âœ…,æœªç™»å½• âŒ" }}
          </p>
          <p><strong>ç”¨æˆ·å:</strong> {{ user.username|default:"æœªç™»å½•" }}</p>
          <p><strong>åˆ†ç±»ID:</strong> {{ category.id }}</p>
          <p><strong>åˆ†ç±»åç§°:</strong> {{ category.name }}</p>
        </div>

        <div
          class="category-actions"
          style="
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
          "
        >
          {% if user.is_authenticated %}

          <button
            id="like_btn"
            data-categoryid="{{ category.id }}"
            class="btn btn-primary btn-lg me-3"
            onclick="likeCategoryFunction();"
            style="
              display: inline-block !important;
              visibility: visible !important;
              opacity: 1 !important;
            "
          >
            <i class="fas fa-thumbs-up me-2"></i>ç‚¹èµåˆ†ç±»
          </button>
          <a
            href="{% url 'add_page' category.slug %}"
            class="btn btn-success btn-lg"
            style="
              display: inline-block !important;
              visibility: visible !important;
              opacity: 1 !important;
            "
          >
            <i class="fas fa-plus me-2"></i>æ·»åŠ é¡µé¢
          </a>
          {% else %}
          <div class="alert alert-warning mb-3">
            <i class="fas fa-exclamation-triangle me-2"></i>
            ç”¨æˆ·æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•æç¤º
          </div>
          <a href="{% url 'auth_login' %}" class="btn btn-primary btn-lg">
            <i class="fas fa-sign-in-alt me-2"></i>ç™»å½•åæ“ä½œ
          </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- é¡µé¢åˆ—è¡¨ -->
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        <div class="card mb-4" data-aos="fade-right">
          <div class="card-header d-flex align-items-center">
            <i class="fas fa-list text-primary me-2"></i>
            <h2 class="card-title mb-0">ğŸ“„ é¡µé¢åˆ—è¡¨</h2>
            <span class="badge bg-primary ms-auto"
              >{{ pages.count }} ä¸ªé¡µé¢</span
            >
          </div>
          <div class="card-body">
            <div id="pages-container">
              {% if pages %}
              <div class="list-group list-group-flush">
                {% for page in pages %}
                <div
                  class="list-group-item page-item d-flex justify-content-between align-items-center"
                  data-aos="fade-up"
                  data-aos-delay="{{ forloop.counter|add:0 }}"
                >
                  <div class="flex-grow-1">
                    <div class="d-flex align-items-center">
                      <i class="fas fa-file-alt text-success me-3"></i>
                      <div>
                        <h6 class="mb-1">
                          <a
                            href="{% url 'goto' %}?page_id={{page.id}}"
                            class="text-decoration-none fw-bold"
                          >
                            {{ page.title }}
                          </a>
                        </h6>
                        <small class="text-muted">
                          <i class="fas fa-external-link-alt me-1"></i>
                          ç‚¹å‡»è®¿é—®é¡µé¢
                        </small>
                      </div>
                    </div>
                  </div>
                  <div class="d-flex align-items-center">
                    <span class="badge bg-info rounded-pill me-2">
                      <i class="fas fa-eye me-1"></i>{{ page.views }}
                    </span>
                    {% if page.is_popular %}
                    <span class="badge bg-warning rounded-pill">
                      <i class="fas fa-fire me-1"></i>çƒ­é—¨
                    </span>
                    {% endif %}
                  </div>
                </div>
                {% endfor %}
              </div>
              {% else %}
              <div class="text-center py-5" data-aos="fade-up">
                <i class="fas fa-file-alt fa-4x text-muted mb-3"></i>
                <h4 class="text-muted">æš‚æ— é¡µé¢</h4>
                <p class="text-muted mb-4">
                  è¿™ä¸ªåˆ†ç±»è¿˜æ²¡æœ‰ä»»ä½•é¡µé¢ï¼Œå¿«æ¥æ·»åŠ ç¬¬ä¸€ä¸ªå§ï¼
                </p>
                {% if user.is_authenticated %}
                <a
                  href="{% url 'add_page' category.slug %}"
                  class="btn btn-primary"
                >
                  <i class="fas fa-plus me-2"></i>æ·»åŠ ç¬¬ä¸€ä¸ªé¡µé¢
                </a>
                {% endif %}
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

      <!-- æœç´¢åŠŸèƒ½ä¾§è¾¹æ  -->
      {% if user.is_authenticated %}
      <div class="col-lg-4">
        <div class="search-section" data-aos="fade-left">
          <div class="card">
            <div class="card-header d-flex align-items-center">
              <i class="fas fa-search text-primary me-2"></i>
              <h3 class="card-title mb-0">ğŸ” æ™ºèƒ½æœç´¢</h3>
            </div>
            <div class="card-body">
              <p class="card-text mb-4">
                ä½¿ç”¨ç™¾åº¦æœç´¢ä¸º
                <strong class="text-primary">{{ category.name }}</strong>
                åˆ†ç±»æ·»åŠ ç›¸å…³é¡µé¢
              </p>

              <!-- æœç´¢è¾“å…¥æ¡† -->
              <div class="input-group mb-3">
                <span class="input-group-text bg-primary text-white">
                  <i class="fas fa-search"></i>
                </span>
                <input
                  type="text"
                  id="search-query"
                  class="form-control"
                  placeholder="è¾“å…¥æœç´¢å…³é”®è¯ï¼Œå¦‚ï¼šPythonæ•™ç¨‹ã€Djangoæ–‡æ¡£..."
                />
                <button class="btn btn-primary" type="button" id="search-btn">
                  <i class="fas fa-search me-1"></i>æœç´¢
                </button>
              </div>

              <!-- æœç´¢å»ºè®® -->
              <div id="search-suggestions" class="mb-3" style="display: none">
                <small class="text-muted mb-2 d-block">
                  <i class="fas fa-lightbulb me-1"></i>æœç´¢å»ºè®®ï¼š
                </small>
                <div id="suggestions-list" class="d-flex flex-wrap gap-2"></div>
              </div>

              <!-- åŠ è½½çŠ¶æ€ -->
              <div
                id="search-loading"
                class="text-center"
                style="display: none"
              >
                <div class="loading-spinner mx-auto mb-3"></div>
                <p class="text-muted mb-0">æ­£åœ¨æœç´¢ç›¸å…³é¡µé¢...</p>
              </div>

              <!-- æœç´¢ç»“æœ -->
              <div id="search-results"></div>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- è¿”å›æŒ‰é’® -->
  <div class="text-center mt-4" data-aos="fade-up">
    <a href="{% url 'index' %}" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-left me-2"></i>è¿”å›ä¸»é¡µ
    </a>
  </div>
</div>

{% else %}
<div class="text-center py-5" data-aos="fade-up">
  <i class="fas fa-exclamation-triangle fa-4x text-warning mb-3"></i>
  <h2 class="text-warning">åˆ†ç±»ä¸å­˜åœ¨</h2>
  <p class="text-muted">æ‚¨è®¿é—®çš„åˆ†ç±»ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤ã€‚</p>
  <a href="{% url 'index' %}" class="btn btn-primary">
    <i class="fas fa-home me-2"></i>è¿”å›ä¸»é¡µ
  </a>
</div>
{% endif %}

<!-- å†…è”jQueryä»£ç å¤„ç†äº¤äº’åŠŸèƒ½ -->
<script>
  // å…¨å±€ç‚¹èµå‡½æ•° - å¿…é¡»åœ¨$(document).ready()å¤–éƒ¨å®šä¹‰
  function likeCategoryFunction() {
    if (typeof $ !== "undefined") {
      // è·å–å‚æ•°
      var categoryId = $("#like_btn").attr("data-categoryid");
      var csrfToken = $("[name=csrfmiddlewaretoken]").val();
      var currentLikes = parseInt($("#like_count").text());

      // å‚æ•°éªŒè¯
      if (!categoryId) {
        alert("é”™è¯¯: åˆ†ç±»IDä¸ºç©º");
        return;
      }

      if (!csrfToken) {
        alert("é”™è¯¯: CSRF Tokenä¸ºç©º");
        return;
      }

      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      $("#like_btn")
        .prop("disabled", true)
        .html('<i class="fas fa-spinner fa-spin me-2"></i>ç‚¹èµä¸­...')
        .removeClass("btn-primary")
        .addClass("btn-info");

      // å‘é€çœŸæ­£çš„AJAXè¯·æ±‚
      $.ajax({
        url: "/like_category/",
        method: "POST",
        data: {
          category_id: categoryId,
          csrfmiddlewaretoken: csrfToken,
        },

        success: function (data, textStatus, xhr) {
          // æ›´æ–°æ˜¾ç¤º
          $("#like_count").text(data);

          // æ›´æ–°æŒ‰é’®çŠ¶æ€
          $("#like_btn")
            .removeClass("btn-info")
            .addClass("btn-success")
            .html('<i class="fas fa-check me-2"></i>å·²ç‚¹èµ')
            .prop("disabled", true);
        },
        error: function (xhr, status, error) {
          // é‡ç½®æŒ‰é’®çŠ¶æ€
          $("#like_btn")
            .prop("disabled", false)
            .removeClass("btn-info btn-success")
            .addClass("btn-primary")
            .html('<i class="fas fa-thumbs-up me-2"></i>ç‚¹èµåˆ†ç±»');

          alert("ç‚¹èµå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
        },
      });
    } else {
      alert("jQueryæœªåŠ è½½ï¼Œæ— æ³•æ‰§è¡Œç‚¹èµ");
    }
  }

  // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
  $(document).ready(function () {
    // æœç´¢åŠŸèƒ½åˆå§‹åŒ–

    // æœç´¢å»ºè®®åŠŸèƒ½
    $("#search-input").keyup(function () {
      var query = $(this).val();
      $.get("/suggest/", { suggestion: query }, function (data) {
        $("#categories-listing").html(data);
      });
    });

    // çœŸæ­£çš„æœç´¢åŠŸèƒ½
    $("#search-btn").click(function () {
      performSearch();
    });

    // å›è½¦é”®æœç´¢
    $("#search-query").keypress(function (e) {
      if (e.which == 13) {
        // Enter key
        performSearch();
      }
    });

    // æœç´¢å»ºè®®åŠŸèƒ½
    var searchTimeout;
    $("#search-query").on("input", function () {
      var query = $(this).val().trim();

      // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
      clearTimeout(searchTimeout);

      if (query.length >= 2) {
        // å»¶è¿Ÿ500msåè·å–å»ºè®®
        searchTimeout = setTimeout(function () {
          getSearchSuggestions(query);
        }, 500);
      } else {
        $("#search-suggestions").hide();
      }
    });

    function performSearch() {
      var query = $("#search-query").val().trim();
      if (query === "") {
        showToast(
          "warning",
          "è¯·è¾“å…¥æœç´¢å…³é”®è¯",
          "è¯·åœ¨æœç´¢æ¡†ä¸­è¾“å…¥è¦æœç´¢çš„å†…å®¹"
        );
        return;
      }

      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      $("#search-loading").show();
      $("#search-results").empty();
      $("#search-suggestions").hide();

      var categoryId = $("[data-category-id]").data("category-id");

      $.ajax({
        url: "/api/search/",
        method: "GET",
        data: {
          query: query,
          category_id: categoryId,
        },
        success: function (data) {
          $("#search-loading").hide();

          if (data.success && data.results.length > 0) {
            displaySearchResults(data.results, query);
            showToast(
              "success",
              "æœç´¢å®Œæˆ",
              `æ‰¾åˆ° ${data.results.length} ä¸ªç›¸å…³ç»“æœ`
            );
          } else {
            $("#search-results").html(
              '<div class="alert alert-info">' +
                '<i class="fas fa-info-circle me-2"></i> æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç»“æœï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯' +
                "</div>"
            );
            showToast("info", "æœç´¢å®Œæˆ", "æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç»“æœï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯");
          }
        },
        error: function (xhr, status, error) {
          $("#search-loading").hide();

          var errorMsg = "æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
          if (xhr.responseJSON && xhr.responseJSON.error) {
            errorMsg = xhr.responseJSON.error;
          }

          $("#search-results").html(
            '<div class="alert alert-danger">' +
              '<i class="fas fa-exclamation-triangle me-2"></i> ' +
              errorMsg +
              "</div>"
          );
          showToast("error", "æœç´¢å¤±è´¥", errorMsg);
        },
      });
    }

    function getSearchSuggestions(query) {
      $.ajax({
        url: "/api/search_suggestions/",
        method: "GET",
        data: { query: query },
        success: function (data) {
          if (data.suggestions && data.suggestions.length > 0) {
            var html = "";
            data.suggestions.forEach(function (suggestion) {
              html +=
                '<span class="badge bg-light text-dark suggestion-item" ' +
                'style="cursor: pointer; font-size: 0.9rem;">' +
                suggestion +
                "</span>";
            });

            $("#suggestions-list").html(html);
            $("#search-suggestions").show();

            // ç‚¹å‡»å»ºè®®
            $(".suggestion-item").click(function () {
              $("#search-query").val($(this).text());
              $("#search-suggestions").hide();
              performSearch();
            });
          } else {
            $("#search-suggestions").hide();
          }
        },
        error: function () {
          $("#search-suggestions").hide();
        },
      });
    }

    function displaySearchResults(results, query) {
      var html = '<div class="mt-3">';
      html +=
        '<h5 class="mb-3"><i class="fas fa-list me-2"></i>æœç´¢ç»“æœ (' +
        results.length +
        "ä¸ªç»“æœ)</h5>";
      html += '<div class="list-group">';

      results.forEach(function (result, index) {
        var existsClass = result.exists ? "list-group-item-secondary" : "";
        var existsText = result.exists
          ? '<span class="badge bg-secondary ms-2">å·²å­˜åœ¨</span>'
          : "";

        html +=
          '<div class="list-group-item ' +
          existsClass +
          ' search-result-item">';
        html +=
          '<div class="d-flex justify-content-between align-items-start">';
        html += '<div class="flex-grow-1">';
        html += '<h6 class="mb-1">';
        html +=
          '<a href="' +
          result.url +
          '" target="_blank" class="text-primary fw-bold">' +
          result.title +
          "</a>";
        html += existsText;
        html += "</h6>";
        html += '<p class="mb-1 text-muted small">' + result.abstract + "</p>";
        html +=
          '<small class="text-muted"><i class="fas fa-link me-1"></i>' +
          result.url +
          "</small>";
        html += "</div>";

        if (!result.exists) {
          html +=
            '<button class="btn btn-success btn-sm add-page-btn ms-3" ' +
            'data-title="' +
            result.title.replace(/"/g, "&quot;") +
            '" ' +
            'data-url="' +
            result.url +
            '">' +
            '<i class="fas fa-plus me-1"></i> æ·»åŠ </button>';
        }

        html += "</div>";
        html += "</div>";
      });

      html += "</div>";
      html += '<div class="mt-3">';
      html += '<small class="text-muted">';
      html +=
        '<i class="fas fa-info-circle me-1"></i> æœç´¢ç»“æœæ¥è‡ªç™¾åº¦æœç´¢ï¼Œç‚¹å‡»"æ·»åŠ "æŒ‰é’®å°†é¡µé¢æ·»åŠ åˆ°å½“å‰åˆ†ç±»';
      html += "</small>";
      html += "</div>";
      html += "</div>";

      $("#search-results").html(html);
    }

    // æ·»åŠ é¡µé¢æŒ‰é’®äº‹ä»¶
    $(document).on("click", ".add-page-btn", function () {
      var title = $(this).data("title");
      var url = $(this).data("url");
      var categoryId = $("[data-category-id]").data("category-id");

      // ç¦ç”¨æŒ‰é’®
      $(this)
        .prop("disabled", true)
        .html('<i class="fas fa-spinner fa-spin me-1"></i> æ·»åŠ ä¸­...');

      $.ajax({
        url: "/search_add_page/",
        method: "GET",
        data: {
          title: title,
          url: url,
          category_id: categoryId,
        },
        success: function (data) {
          // æ›´æ–°é¡µé¢åˆ—è¡¨
          $("#pages-container").html(data);

          // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
          showToast("success", "æ·»åŠ æˆåŠŸ", `é¡µé¢ "${title}" å·²æˆåŠŸæ·»åŠ åˆ°åˆ†ç±»`);

          // é‡æ–°å¯ç”¨æŒ‰é’®å¹¶æ ‡è®°ä¸ºå·²æ·»åŠ 
          $(".add-page-btn")
            .prop("disabled", false)
            .html('<i class="fas fa-plus me-1"></i> æ·»åŠ ');
          $(".add-page-btn[data-title='" + title.replace(/"/g, "&quot;") + "']")
            .prop("disabled", true)
            .html('<i class="fas fa-check me-1"></i> å·²æ·»åŠ ')
            .removeClass("btn-success")
            .addClass("btn-secondary");
        },
        error: function (xhr, status, error) {
          // é‡æ–°å¯ç”¨æŒ‰é’®
          $(".add-page-btn")
            .prop("disabled", false)
            .html('<i class="fas fa-plus me-1"></i> æ·»åŠ ');

          var errorMsg = "æ·»åŠ é¡µé¢å¤±è´¥ï¼Œè¯·é‡è¯•";
          if (xhr.responseJSON && xhr.responseJSON.error) {
            errorMsg = xhr.responseJSON.error;
          }

          showToast("error", "æ·»åŠ å¤±è´¥", errorMsg);
        },
      });
    });
  });

  // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
  function showToast(type, title, message) {
    var icon = "";
    var bgClass = "";

    switch (type) {
      case "success":
        icon = "fas fa-check-circle";
        bgClass = "bg-success";
        break;
      case "error":
        icon = "fas fa-exclamation-circle";
        bgClass = "bg-danger";
        break;
      case "warning":
        icon = "fas fa-exclamation-triangle";
        bgClass = "bg-warning";
        break;
      case "info":
        icon = "fas fa-info-circle";
        bgClass = "bg-info";
        break;
    }

    var toastHtml = `
            <div class="toast show" role="alert">
                <div class="toast-header ${bgClass} text-white">
                    <i class="${icon} me-2"></i>
                    <strong class="me-auto">${title}</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            </div>
        `;

    // æ·»åŠ åˆ°toastå®¹å™¨
    if (!$(".toast-container").length) {
      $("body").append(
        '<div class="toast-container position-fixed bottom-0 end-0 p-3"></div>'
      );
    }

    $(".toast-container").append(toastHtml);

    // è‡ªåŠ¨éšè—
    setTimeout(function () {
      $(".toast").last().fadeOut();
    }, 5000);
  }
</script>

<style>
  /* åˆ†ç±»å¤´éƒ¨æ ·å¼ */
  .category-header {
    background: linear-gradient(
      135deg,
      rgba(99, 102, 241, 0.1),
      rgba(139, 92, 246, 0.1)
    );
    border-radius: var(--border-radius);
  }

  /* åˆ†ç±»æ“ä½œæŒ‰é’®æ ·å¼ */
  .category-actions {
    margin-top: 1.5rem;
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .category-actions .btn {
    min-width: 140px;
    font-weight: 500;
    transition: var(--transition);
  }

  .category-actions .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  }

  .category-stats .stat-item {
    padding: 0.5rem 1rem;
    background: rgba(255, 255, 255, 0.8);
    border-radius: 25px;
    backdrop-filter: blur(10px);
    transition: var(--transition);
  }

  .category-stats .stat-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  /* é¡µé¢é¡¹ç›®æ ·å¼ */
  .page-item {
    transition: var(--transition);
    border: none;
    margin-bottom: 0.5rem;
    border-radius: var(--border-radius) !important;
    padding: 1rem;
  }

  .page-item:hover {
    background: linear-gradient(
      135deg,
      rgba(99, 102, 241, 0.05),
      rgba(139, 92, 246, 0.05)
    );
    transform: translateX(5px);
  }

  /* æœç´¢åŒºåŸŸæ ·å¼ */
  .search-section {
    position: sticky;
    top: 2rem;
  }

  .search-result-item {
    transition: var(--transition);
    border: none;
    margin-bottom: 0.5rem;
    border-radius: var(--border-radius) !important;
  }

  .search-result-item:hover {
    background: linear-gradient(
      135deg,
      rgba(99, 102, 241, 0.05),
      rgba(139, 92, 246, 0.05)
    );
    transform: translateX(5px);
  }

  /* å»ºè®®æ ·å¼ */
  .suggestion-item {
    transition: var(--transition);
    border: 1px solid rgba(99, 102, 241, 0.2);
  }

  .suggestion-item:hover {
    background: var(--primary-color) !important;
    color: white !important;
    transform: scale(1.05);
  }

  /* æŒ‰é’®åŠ è½½çŠ¶æ€ */
  .btn-loading {
    pointer-events: none;
  }

  /* æ·±è‰²æ¨¡å¼é€‚é… */
  [data-bs-theme="dark"] .category-stats .stat-item {
    background: rgba(31, 41, 55, 0.8);
    color: white;
  }

  [data-bs-theme="dark"] .page-item:hover,
  [data-bs-theme="dark"] .search-result-item:hover {
    background: linear-gradient(
      135deg,
      rgba(99, 102, 241, 0.1),
      rgba(139, 92, 246, 0.1)
    );
  }

  [data-bs-theme="dark"] .suggestion-item {
    background: rgba(31, 41, 55, 0.8) !important;
    color: white !important;
    border-color: rgba(255, 255, 255, 0.2);
  }

  [data-bs-theme="dark"] .suggestion-item:hover {
    background: var(--primary-color) !important;
    color: white !important;
  }
</style>

{% endblock %}
